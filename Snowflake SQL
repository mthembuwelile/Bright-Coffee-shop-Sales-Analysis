SELECT * FROM PROJECTS.COFFEE_SHOP.SALES;

SELECT COUNT(*) AS NUMBER_OF_ROWS
FROM SALES;

SELECT COUNT(TRANSACTION_ID) AS NUMBER_OF_SALES
FROM SALES;

SELECT SUM(TRANSACTION_QTY) AS NUMBER_OF_UNITS_SOLD
FROM SALES;

SELECT TRANSACTION_QTY*UNIT_PRICE AS REVENUE_PER_TRANSACTION 
FROM SALES;

SELECT SUM(TRANSACTION_QTY*UNIT_PRICE) AS TOTAL_REVENUE 
FROM SALES;

-- TOTAL REVENUE BY CATEGORY 
SELECT SUM(TRANSACTION_QTY*UNIT_PRICE) AS TOTAL_REVENUE ,
PRODUCT_CATEGORY
FROM SALES
GROUP BY PRODUCT_CATEGORY
ORDER BY TOTAL_REVENUE DESC;

--EARLIEST TIME THE SHOP OPENS 
SELECT MIN(TRANSACTION_TIME)
FROM SALES;

--LASTES TIME THE STORE CLOSES: 
SELECT MAX(TRANSACTION_TIME)
FROM SALES;

SELECT MAX(TRANSACTION_QTY*UNIT_PRICE) 
FROM SALES;

SELECT MIN(TRANSACTION_QTY*UNIT_PRICE) 
FROM SALES;

SELECT TO_CHAR(TRANSACTION_DATE, 'YYYYMM') AS MONTH_ID,
FROM SALES;


SELECT
SUM(TRANSACTION_QTY*UNIT_PRICE) AS TOTAL_REVENUE,
SUM(TRANSACTION_QTY) AS NUMBER_OF_UNITS_SOLD,
COUNT(TRANSACTION_ID) AS NUMBER_OF_SALES,
TO_CHAR(TRANSACTION_DATE, 'YYYYMM') AS MONTH_ID,
MONTHNAME(TRANSACTION_DATE) AS MONTH_NAME,
DAYNAME(TRANSACTION_DATE) AS DAY_NAME,
CASE
 WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'MORNING'
 WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '16:59:59' THEN 'AFTERNOON'
 WHEN TRANSACTION_TIME BETWEEN '17:00:00' AND '20:59:59' THEN 'EVENING'
ELSE 'NIGHT'
END AS TIME_BUCKET,
CASE 
WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 0 AND 100 THEN 'LOW'
WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 101 AND 250 THEN 'MEDIUM'
WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 251 AND 300 THEN 'HIGH'
ELSE 'HIGH_SPEND'
END AS SPEND_BANDS,
PRODUCT_CATEGORY,
PRODUCT_TYPE,
PRODUCT_DETAIL,
STORE_LOCATION,
FROM SALES
GROUP BY TIME_BUCKET,
PRODUCT_CATEGORY,
PRODUCT_TYPE,
PRODUCT_DETAIL,
STORE_LOCATION,
MONTH_ID,
MONTH_NAME,
DAY_NAME;
